\section{Application -- Milky Way rotation curve}
\label{sec:rotation_curve}

\subsection{Rotation curve fitting}
\label{sec:rotation_fit}
The Milky Way ISM's velocity field can be decomposed into a Galactic rotation curve and streaming motions. 
The magnitude and radial dependence of the rotation curve contain information on the integral and radial profile of the Galaxy's mass distribution and streaming motions indicate perturbations in the Galactic potential, such as spiral arms and the bar.
Since there are many derivations of the Galactic rotation curve in the literature, we can also use it as a check of the accuracy of our $\vlos$ map on large spatial scales, complementing the previous section's validation on small spatial scales.

We derive the Galactic rotation curve by comparing the observed $\vlos(\glon, d)$ to line-of-sight velocities corresponding to different combinations of rotation curves and Galactic parameters. 
The line-of-sight velocity $\vlos$ at a Galactic longitude $\glon$ and heliocentric distance $d$ in the Galactic plane (meaning at $\glat=0^\circ$) is 
\begin{equation}
\label{eqn:vlos_mean}
\vlos(\glon, d) = \frac{V_\phi (\RGC) R_\odot \sin\glon}{\RGC} + 
\frac{V_R (\RGC) \left(R_\odot \cos \glon + d (1 - 2 \cos^2 \glon)  \right) }{\RGC} - V_{\phi, \odot} \sin \glon + V_{R, \odot} \cos \glon,
\end{equation}
where $V_\phi$ and $V_R$ are azimuthal (increasing clockwise) and radial (increasing outward from the Galactic center) velocities, $R_\odot$, $V_{\phi, \odot}$, and $V_{R, \odot}$ are the Galactocentric radius, azimuthal velocity, and radial velocity of the Sun, and $\RGC$ is the Galatocentric distance to the point specified by $\glon$ and $d$:
\begin{equation}
\RGC = \sqrt{R^2_\odot + d^2 - 2 R_\odot d \cos \glon}.
\end{equation}
Here, we have assumed that $V_\phi$ and $V_R$ depend only on $\RGC$, meaning that they are constant as a function of Galactic azimuth.
We will assume that there are no azimuthally constant radial flows, meaning that $V_R(\RGC) \equiv 0\text{ km/sec}$.
Following, e.g., \citet{Reid:2009jb} and \citet{Bovy_2009}, we allow for non-zero azimuthal and radial velocity dispersions, parametrized as independent normal distributions. 
In this parametrization, the line-of-sight velocity dispersion at a single location is a normal distribution with variance
\begin{equation}
\label{eqn:vlos_var}
\sigma^2_\mathrm{los} = \left(\sigma_\phi \frac{R_\odot \sin \glon}{\RGC} \right)^2 + 
\left(\sigma_R  \frac{R_\odot \cos \glon + d (1 - 2 \cos^2 \glon)}{\RGC} \right)^2,
\end{equation}
where $\sigma_\phi$ and $\sigma_R$ are the standard deviations of the azimuthal and radial velocity dispersions. 

We use two models for the rotation curve and other Galactic parameters. 
In the first case, we assume a flat rotation curve, expressed as a single radially constant $V_\phi(\RGC) \equiv V_\phi$, and solve for the best-fit $V_\phi$, $V_{\phi, \odot}$, $V_{R, \odot}$, $\RGC$, $\sigma_\phi$, and $\sigma_R$. 
In the second, we assume a continuous, piecewise linear rotation curve and fix the Galactic parameters to a fiducial set of values -- $\RGC = 8.1\text{ kpc}$, $V_{\phi, \odot} - V_{\phi} = 15.3 \text{ km/sec}$, and $V_{R, \odot} = - 10.3 \text{ km/sec}$. 
In the first case, we only use $\vlos$ measurements within the nearest 4 kpc.
This avoids the inner 4 kpc of the Galaxy, where the rotation curve is known to be non-flat.
In the second case, we use $\vlos$ measurements that are between 2 and 15 kpc from the Galactic center on the near side of the Galaxy. 
The breakpoints of the piecewise linear curve are placed every 0.25 kpc.

Our results for the parameters of the first model are $\RGC=8.90 \pm 0.04 \text{ kpc}$, $V_\phi = 279 \pm 1.5 \text{ km/sec}$, $V_{\phi, \odot} - V_\phi = 28.5 \pm 0.1 \text{ km/sec}$, and $V_{R, \odot} = 6.2 \pm 0.1 \text{ km/sec}$.
While the formal uncertainties on these values are small, we can tell that the systematic uncertainties must be large, particularly on $\RGC$ and $V_\phi$, because the results depend strongly on which portion of the measurements we include in the fit.
The parameter values we give above use the measurements from the nearest 4 kpc of the Galactic disk.
If we instead use measurements from the nearest 3 kpc, we find that $\RGC$ changes to $8.05 \pm 0.06 \text{ kpc}$ and $V_\phi$ remains unchanged, while if we use measurements from the nearest 6 kpc and exclude the inner Galaxy by only using sightlines with $\glon > 45^\circ$, we get $\RGC = 7.43 \pm 0.03 \text{ kpc}$ and $V_\phi = 223 \pm 1 \text{ km/sec}$.
We believe the cause of these large changes in parameter values is that as we vary the region being analyzed, we include and exclude different large-scale streaming motions. 
Since these large-scale streaming motions are not included in the model specification, they end up dragging parameters in different directions.
We discuss this further in Section \ref{sec:rotation_discussion}.

The piecewise-linear rotation curve is shown in Figure \ref{fig:rotation_curves}, with the \Clemens rotation curve for comparison. 
These two non-flat rotation curves mostly agree, in the sense that deviations from flat rotation have the same sign, if not always the same magnitude.

\subsection{The rotation curve of the Milky Way ISM and large-scale streaming motions}
\label{sec:rotation_discussion}
In Figure \ref{fig:six_pies}, we show residuals between the $\vlos$ measurements and (panel b) the flat rotation curve derived from the nearest 4 kpc and (panel c) the piecewise-linear rotation curve. 
For comparison, we also show residuals between the $\vlos$ measurements and (panel a) our fiducial flat rotation curve and Galactic parameters, (panel d) the \Clemens non-flat rotation curve, (panel e) the \cite{2012ApJ...759..131B} flat rotation curve, (panel f) and the \Reid A5 model flat rotation curve.
In every panel, there are obvious, multi-kpc regions with consistent non-zero velocity residuals.
Most of these regions persist across all six panels, though there is some panel-to-panel variation in the exact bounds and residual magnitude of each region. 
For example, there is always a blue-shifted feature just outside the solar circle at $90^\circ \lesssim \glon \lesssim 180^\circ$, a smaller red-shifted feature $\approx 12$ kpc from the Galactic center at the high-$\glon$ boundary of the map, and another red-shifted feature just inside the solar circle. 

Persistence across different sets of rotation curves and Galactic parameters merely provides evidence that the spatially coherent residuals are not caused by a misspecification of the global Galactic motion and geometry.
We can argue for the accuracy of most of the residual regions by taking the HMSFR measurements as truth and appealing to the regions' strong spatial coherence.
The argument goes as follows -- if the $\vlos$ map accurately predicts the velocities of HMSFRs that are spatially coincident with a specific residual region, it is reasonable to assume that the $\vlos$ values assigned to the rest of that region are also likely to be accurate. 
Based on the discussion in Section \ref{sec:KT-validation}, we can claim that the HMSFR velocities are accurately predicted everywhere outside of the inner 4-5 kpc of the Galaxy or so.
A visual inspection of Figure \ref{fig:maser_pie} shows that there are HMSFRs in every residual region within about 6 kpc of the Sun. 
We interpret the combination of these two facts as evidence that all of the residual regions shown in Figures \ref{maser_pie} and \ref{six_pies} outside of the inner 4-5 kpc of the galaxy are, in fact, actually present in the velocity field of the Milky Way ISM. 
